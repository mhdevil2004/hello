workflows:
  ios-simulator-fixed:
    name: iOS Simulator Build
    environment:
      flutter: stable
      xcode: latest
      cocoapods: default
    scripts:
      - name: Force recreate iOS project
        script: |
          echo "Current directory:"
          pwd
          echo "Directory contents:"
          ls -la
          
          # Remove existing iOS directory completely
          rm -rf ios
          
          # Recreate iOS project with proper parameters
          flutter create --org com.example.helloapp . --platforms=ios
          
          echo "After flutter create - iOS directory:"
          ls -la ios/
      - name: Get dependencies
        script: |
          flutter pub get
      - name: Build iOS (simulator)
        script: |
          flutter build ios --simulator --debug --verbose
    artifacts:
      - build/ios/iphonesimulator/**/*.app